<html>
<head>
  <title>Lesson 0</title>
  <style>
    body {margin: 0px}
    canvas {width: "100%"; height: "100%"}
  </style>
  </head>
<body>
  <script src="js/three.min.js"></script>
  <script src="js/dat.gui.min.js"></script>
  <script>
    var raycaster, scene, camera, renderer, container;
    var cube, material;
    
    var mouse = new THREE.Vector2();
    
    var userInterface = new function() {
      this.size = '100';
      this.kolor_tla = "#a6caf0";
      this.rzutowanie = false;
    }
    var gui = new dat.GUI();

    var bgColor = gui.addColor(userInterface, 'kolor_tla');
//    bgColor.onChange(function(value) {
//      console.log(value);
//      renderer.setClearColor(value);
//    });
//    
    init();
    render();
    
    function render() {
      requestAnimationFrame(render);

      camera.lookAt(scene.position);
      camera.updateMatrixWorld();

      cube.rotation.x += 0.01;
      cube.rotation.y += 0.01;
      
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(cube);
      if(intersects.length > 0){
          alert("trafiony");
//        for (var i = 0; i < intersects.length; i++) {
//          intersects[i].object.material.color.set("red");
//        }
      }
      renderer.render(scene, camera);
    }
    
    function init(){
      container = document.createElement("div");
      document.body.appendChild(container);
      scene = new THREE.Scene();
//    var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 1, 1000);
      camera = new THREE.OrthographicCamera( window.innerWidth / - 2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / - 2, 1, 1000 );
    
      renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setClearColor("#a6caf0");
      renderer.setPixelRatio( window.devicePixelRatio );
      renderer.setSize(window.innerWidth,window.innerHeight);
      container.appendChild(renderer.domElement);
      
      raycaster = new THREE.Raycaster();
      
      var geometry = new THREE.BoxGeometry(100, 100, 100);
      material = new THREE.MeshBasicMaterial( {color: "green"});
      cube = new THREE.Mesh(geometry, material);
      cube.position.z = -500;
    
      scene.add(cube);
      
      document.addEventListener("resize",onResize,false);
      window.addEventListener("mousemove",onMove,false);
      window.addEventListener('click', onClick, false);
      
    }
    
    function onResize(){
      camera.left = window.innerWidth/-2;
      camera.right = window.innerWidth/2;
      camera.top = window.innerHeight/2;
      camera.down = window.innerWidth/-2;

      camera.updateProjectionMatrix();
      
      renderer.setSize(window.innerWidth, window.innerHeight);
    }
    
    function onMove(event){
      event.preventDefault();
      mouse.x = (event.clientX/window.innerWidth)*2-1;
      mouse.y = -(event.clientY/window.innerHeight)*2+1;
    }
    
    function onClick(event){
      mouse.x = (event.clientX/window.innerWidth)*2-1;
      mouse.y = -(event.clientY/window.innerHeight)*2+1;
      alert(mouse.x+' '+mouse.y);
    }
  </script>
</body>
</html>
